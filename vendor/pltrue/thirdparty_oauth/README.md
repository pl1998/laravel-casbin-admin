<h1> thirdparty_oauth </h1>

<p> è¿™æ˜¯ä¸€ä¸ªPHPç¤¾ä¼šåŒ–ç™»å½•çš„ç¬¬ä¸‰æ–¹ç™»å½•æ‰©å±•åŒ…</p>

<a href="https://packagist.org/packages/pltrue/thirdparty_oauth"><img src="https://img.shields.io/badge/license-MIT-green" /></a> 
[![Build Status](https://travis-ci.org/pl1998/thirdparty_oauth.svg?branch=master)](https://travis-ci.org/pl1998/thirdparty_oauth)
![StyleCI build status](https://github.styleci.io/repos/295677202/shield)
<a href="https://packagist.org/packages/pltrue/thirdparty_oauth"><img src="https://img.shields.io/badge/php-v7.0+-blue" /></a> 
<a href="https://packagist.org/packages/pltrue/thirdparty_oauth"><img src="https://img.shields.io/badge/downloads-37-brightgreen" /></a> 


## å…¼å®¹
> * æ”¯æŒphp >=7.2
> å…¼å®¹laravel* 


```shell
# phpunitç‰ˆæœ¬ä½ éœ€è¦å…¼å®¹php7<= laravelé«˜ç‰ˆæœ¬å®‰è£…
 composer require pltrue/thirdparty_oauth  --with-all-dependencies
```



## ç›®å‰æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•

    
 * 1.QQ(app/h5/web)
 * 2.å¾®ä¿¡(webæ‰«ç )
 * 3.å¾®åš(app/h5/web)
 * 4.å°ç±³(web/h5)
 * 5.æŠ–éŸ³
 * 6.ä¸–çºªäº’è”(å¾®è½¯)
 * 7.å¾®è½¯
 * 8.gitee
 * 9.github
 * 10.gitlab
 * 11.google(æœ‰å¢™)
 * 12.line

## å®‰è£…

```shell
$ composer require pltrue/thirdparty_oauth 
```

<hr>

## è´¡çŒ®
ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼åšå‡ºè´¡çŒ®:

1. bugåé¦ˆ   [issue tracker](https://github.com/pl1998/thirdparty_oauth/issues).
2. å›ç­”é—®é¢˜æˆ–ä¿®å¤é”™è¯¯ [issue tracker](https://github.com/pl1998/thirdparty_oauth/issues).
3. è´¡çŒ®æ–°ç‰¹æ€§æˆ–æ›´æ–°wikiã€‚

## è´¡çŒ®è€…ğŸ‰ã€ä»¥åŠåˆå¹¶æ—¥å¿—

| æ—¥æœŸ   | æ›´æ–°çº§åˆ« | æ›´æ–°å†…å®¹      | è´¡çŒ®è€… | å½“å‰çŠ¶æ€ |
| ------| -------- | --------- | ---- | ---- |
| 2020-12-06|   fix ã€feat   | æ–°å¢`Microsoft`ç™»å½• ä¿®å¤å¾®ä¿¡ã€QQçš„bug   | [742481030](https://github.com/742481030)     | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-08|   feat         | æ–°å¢`å°ç±³è´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-09|   feat         | æ–°å¢`googleè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-10|   feat         | æ–°å¢`åä¸ºè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-11|   fix         | qqç»Ÿä¸€ä½¿ç”¨jsonæ¥å£    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-12|   feat         | æ–°å¢`æŠ–éŸ³è´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-13|   feat         | æ–°å¢`Lineè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-29|   fix         | å¢åŠ å…¼å®¹æ”¯ä»˜å®qq appæ··åˆåº”ç”¨å…¼å®¹   | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-29|   feat         | æ–°å¢`äº¬ä¸œè´¦æˆ·`ç™»å½•    | [742481030](https://github.com/742481030)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |
| 2020-12-29|   fix          | å…¼å®¹laravel7*    | [pl1998](https://github.com/pl1998)  | å·²åˆå¹¶åˆ°masteråˆ†æ”¯     |



## å¦‚ä½•ä½¿ç”¨

> * [phpé¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•1)
> * [åœ¨Thinkphpä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•2)
> * [åœ¨laravelä¸­å¦‚ä½•ä½¿ç”¨?](#æµ‹è¯•3)


<hr>

## å¦‚ä½•ç”³è¯·åº”ç”¨æˆæƒï¼Ÿ
    
   * [githubåº”ç”¨åˆ›å»ºåœ°å€](https://github.com/settings/developers)
   * [giteeåº”ç”¨åˆ›å»ºåœ°å€](https://gitee.com/oauth/applications)
   * [gitlabåº”ç”¨åˆ›å»ºåœ°å€](https://gitlab.com/oauth/applications)
   * [å¾®åšåº”ç”¨åˆ›å»ºåœ°å€](https://open.weibo.com/)
   * [microcoftåº”ç”¨åˆ›å»ºåœ°å€](https://azure.com/)
   * [QQäº’è”åˆ›å»ºåœ°å€](https://connect.qq.com/index.html)
   * [å°ç±³åº”ç”¨](https://dev.mi.com/console/)
   * [googleåº”ç”¨](https://console.developers.google.com)
   * [äº¬ä¸œåº”ç”¨](https://jos.jd.com/)
   

##### å‚æ•°è¯´æ˜ 

>   <kbd>redirect_url</kbd>   å›è°ƒåœ°å€å°†ä½¿ç”¨æ–¹æ³•å†™åˆ°å›è°ƒæ¥å£å³å¯ è·å–åˆ°ç”¨æˆ·çš„ä¸€äº›åŸºç¡€ä¿¡æ¯ <br/>
> <kbd>client_id</kbd>     åº”ç”¨æˆæƒid <br/>
>  <kbd>client_secret</kbd>  åº”ç”¨æˆæƒkey <br/>
>  æ‰€æœ‰æ”¯æŒå¹³å°çš„ç±»å‹ `github` `gitee` `gitlab` `weibo` `qq` `weixin` `alipay` `microsoft` é…ç½®æ–‡ä»¶ä¸‹æ ‡ä¸€è‡´



##### å»ºè®®

> å‰åç«¯åˆ†ç¦»ä¸‹å»ºè®®å‰ç«¯ç›´æ¥è¯·æ±‚æˆæƒæ¥å£ï¼Œåç«¯è´Ÿè´£å›è°ƒæ¥å£å³å¯

## <a id="æµ‹è¯•1">phpé¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨</a>

<hr>

<br/>
<br/>

#### æˆæƒæ–¹æ³•  



```php

require __DIR__ .'/vendor/autoload.php';

use Pl1998\ThirdpartyOauth\SocialiteAuth;

$api = new SocialiteAuth([
    'client_id' => '74ee75f10437b4862d653a682111e5ddca1d24422f00ec884453ad232ae07ac9',
    'redirect_uri' => 'http://oauth.test/test.php',
    'client_secret'=>''
]);

return $api->redirect('github');

```
    
#### å›è°ƒæ¥å£æ–¹æ³•

```php

require __DIR__ .'/vendor/autoload.php';

use Pl1998\ThirdpartyOauth\SocialiteAuth;

$api = new SocialiteAuth([
    'client_id' => '74ee75f10437b4862d653a682111e5ddca1d24422f00ec884453ad232ae07ac9',
    'redirect_uri' => 'http://oauth.test/test.php',
    'client_secret' => ''
]);

$user = $api->driver('github')->user();

var_dump($user);die;

```

<br/>

## <a id="æµ‹è¯•2">åœ¨Thinkphpä¸­å¦‚ä½•ä½¿ç”¨?</a>


<hr>

```php

//åœ¨è·¯ç”±æ–‡ä»¶æ–°å»ºä¸¤æ¡è·¯ç”±
Route::get('authorization','api/TestController/authorization')->name('è¯·æ±‚æˆæƒ');
Route::get('gitee/callback','api/TestController/giteeCallback')->name('æˆæƒå›è°ƒæ¥å£');

```

## é…ç½®æ–‡ä»¶

```php
return [
    'github' => [
            'client_id' => '2365a07a73dc25a27e5c7a968248b96beb53a1ad300de7ba6bf4ffe247a4b386',
            'redirect_uri' => 'http://test.test/gitee/callback',
            'client_secret' => ''
        ]
];

```



```php

<?php
/**
 * Created by PhpStorm
 * User: pl
 * Date: 2020/9/17
 * Time: 14:56
 */

namespace app\api\controller;

use Pl1998\ThirdpartyOauth\SocialiteAuth;
use think\facade\Config;

class TestController
{


    /**
     * è¯¥æ–¹æ³•é‡å®šå‘åä¼šæ‰§è¡ŒgiteeCallback() æ–¹æ³•
     * @return int
     */
    public function authorization()
    {
        $auth = new SocialiteAuth(Config::get('oauth.github'));

        return $auth->redirect('github');

    }

    /**
     * @throws \Pl1998\ThirdpartyOauth\Exceptions\InvalidArgumentException
     */
    public function giteeCallback()
    {
        $api = new SocialiteAuth(Config::get('oauth.github'));

        $user = $api->driver('github')->user();

        var_dump($user);

        //åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨è¡¨ä¸­ ç„¶åå­˜å…¥session æˆ–è€…é¢å‘token è¿”å›ç»™å‰ç«¯
    }
}

```

## <a id="æµ‹è¯•3">åœ¨laravelä¸­å¦‚ä½•ä½¿ç”¨?</a>


> åœ¨laravleçš„ <kbd>service.php</kbd>é…ç½®æ–‡ä»¶ä¸­åŠ å…¥é…ç½®

```php

  'oauth' => [
         'github' => [
             'client_id'    => env('GITHUB_CLIENT_ID'),
             'redirect_uri' => env('GITHUB_REDIRECT_URI'),
             'client_secret'=>env('GITHUB_CLIENT_SECRET')
         ]
  ]
```

#### åœ¨ <kbd>.env</kdb>ä¸­é…ç½®

```shell
GITHUB_CLIENT_ID=684a49aa60ce
GITHUB_CLINET_SECRETS=86c3800b0da6b6687e7572a9251860
GITHUB_CALLBACK_URL=http://test.test/callback/github
```

## åˆ›å»ºè·¯ç”±

```php
Route::get('auth/github-redirect','OauthController@redirect');
Route::get('callback/github','OauthController@auth');
```


##å¦‚æœè¦ä½¿ç”¨laravel app æ³¨å…¥ã€‚å…ˆåœ¨`config/app.php`æ³¨å†ŒæœåŠ¡æä¾›è€… 

```php
   ....
    'providers' => [
       \Pl1998\ThirdpartyOauth\ServiceProvider::class
    ]
```


## æ§åˆ¶å™¨æ–¹æ³•

```php
<?php


namespace App\Http\Controllers;
use Pl1998\ThirdpartyOauth\SocialiteAuth;

class OauthController extends Controller
{
    public function redirect()
    {
        //return   app('SocialiteAuth')->redirect('weibo');
        $api = new SocialiteAuth(config('services.oauth.github'));
        return $api->redirect('github');
    }
    public function auth()
    {
       // $api =    app('SocialiteAuth')->driver('weibo');
        //dd($api->user())
        $api = new SocialiteAuth(config('services.oauth.github'));
        $user = $api->driver('github')->user();
        dd($user);
    }
}



```

## è¿”å›ç¤ºä¾‹

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210115174351473.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMDMyMTE3,size_16,color_FFFFFF,t_70#pic_center)

<br/>

## License
<hr>
MIT
